<!-- Ïú†Ï†Ä Î¶¨Ïä§Ìä∏ ÌéòÏù¥ÏßÄ Ï°∞Ìöå ÌéòÏù¥ÏßÄ -->

<!DOCTYPE html>
<html lang="ko">
  <head>
    <title>User List Page</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/@picocss/pico@1.*/css/pico.min.css"
    />
  </head>

  <style>
    .wrapper {
      width: 800px;
      margin: auto;
    }
  </style>

  <script>
    const { email, name, photo } = JSON.parse(
      localStorage.getItem("user-info")
    );

    console.log(email, name, photo);
    currentUser = [name, email, photo];

    $(document).ready(function () {
      $(".admin").hide();
      if (currentUser[0] === "admin" && currentUser[1] === "admin") {
        $(".admin").show();
      }
    });

    // Ïú†Ï†Ä ÏÇ≠Ï†ú API
    function deleteUser(name) {
      $.ajax({
        type: "POST",
        url: "/api/deleteUser",
        data: { name_give: name },
        success: function (response) {
          if (response["result"] == "success") {
            alert("ÏÇ≠Ï†ú ÏôÑÎ£å!");
            location.reload();
          }
        },
      });
    }
  </script>
  <body>
    <!-- Îí§Î°úÍ∞ÄÍ∏∞Î≤ÑÌäº - ÌôàÌéòÏù¥ÏßÄÏôÄ Ïó∞Í≤∞ ÌïÑÏöî -->
    <a href="/home" role="button" class="outline">Îí§Î°úÍ∞ÄÍ∏∞</a>

    <div class="wrapper">
      <h1>User List</h1>
      <table>
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Name</th>
            <th scope="col">Email</th>
            <th scope="col" , class="admin">üò†</th>
          </tr>
        </thead>
        {% for user in users %}
        <tbody>
          <tr>
            <!-- ID Ìñâ Ï∂îÍ∞Ä -->
            <!-- <th scope="row">{{ user['_id'] }}</th> -->
            <th scope="row">#</th>
            <td>{{ user['name'] }}</td>
            <td>{{ user['email'] }}</td>
            {% if user['name'] != 'admin' %}
            <td onclick="deleteUser(`{{ user['name'] }}`)" class="admin">‚ùå</td>
            {% endif %}
          </tr>
        </tbody>
        {% endfor%}
      </table>
    </div>
  </body>
</html>
